(this["webpackJsonpreact-complete-guide"]=this["webpackJsonpreact-complete-guide"]||[]).push([[0],{107:function(e,t,n){},229:function(e,t,n){"use strict";n.r(t);var r,a=n(38),o=n.n(a),s=n(13),c=n(11),i=n(44),l=localStorage.getItem("token"),u=!!l,d=Object(i.b)({name:"auth",initialState:{token:l,isLoggedIn:u},reducers:{logout:function(e){e.token="",e.isLoggedIn=!1,localStorage.removeItem("token"),r&&clearTimeout(r)},login:function(e,t){e.token=t.payload.token,e.isLoggedIn=!0;var n=function(e){var t=(new Date).getTime();return new Date(e).getTime()-t}(t.payload.expirationTime);localStorage.setItem("token",t.payload.token),localStorage.setItem("expirationTime",n),r=setTimeout((function(){localStorage.removeItem("token")}),n)},saveLoginToken:function(e,t){e.token=t.payload}}}),j=d.actions,b=d,h=Object(i.a)({reducer:{auth:b.reducer}}),m=(n(107),n(3)),p=n(0),x=n(56),O=n.n(x),g=n(1),f=function(){var e=Object(c.c)((function(e){return e.auth.isLoggedIn})),t=Object(c.b)();return Object(g.jsxs)("header",{className:O.a.header,children:[Object(g.jsx)(s.b,{to:"/",children:Object(g.jsx)("div",{className:O.a.logo,children:"React Auth"})}),Object(g.jsx)("nav",{children:Object(g.jsxs)("ul",{children:[!e&&Object(g.jsx)("li",{children:Object(g.jsx)(s.b,{to:"/auth",children:"Login"})}),e&&Object(g.jsx)("li",{children:Object(g.jsx)(s.b,{to:"/profile",children:"Profile"})}),e&&Object(g.jsx)("li",{children:Object(g.jsx)("button",{onClick:function(){t(j.logout())},children:"Logout"})})]})})]})},w=function(e){return Object(g.jsxs)(p.Fragment,{children:[Object(g.jsx)(f,{}),Object(g.jsx)("main",{children:e.children})]})},v=n(26),k=n.n(v),_=n(39),S=n(45),N=n.n(S),y=n(15),F=n(23),I=n(43),P=n.n(I),T=function(){var e=Object(c.c)((function(e){return e.auth.token})),t=Object(m.g)(),n=F.a().shape({newPassword:F.b().min(8,"At least 8 characters")}),r=function(){var n=Object(_.a)(k.a.mark((function n(r,a,o){var s;return k.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,P.a.post("https://identitytoolkit.googleapis.com/v1/accounts:update?key=AIzaSyDXr0-DCQ8hUW6bsSpFmjNHHNokGFOQIBY",{idToken:e,password:r.newPassword,returnSecureToken:!1});case 3:a(!1),o(),t.replace("/"),n.next=16;break;case 8:throw n.prev=8,n.t0=n.catch(0),s="Authentication failed!",n.t0.response&&n.t0.response.data&&n.t0.response.data.error&&n.t0.response.data.error.message&&(s=n.t0.response.data.error.message),alert(s),a(!1),o(),new Error(s);case 16:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e,t,r){return n.apply(this,arguments)}}();return Object(g.jsx)(y.c,{initialValues:{newPassword:""},validationSchema:n,onSubmit:function(e,t){var n=t.setSubmitting,a=t.resetForm;r(e,n,a)},children:function(e){var t=e.isSubmitting,n=e.errors;return Object(g.jsxs)(y.b,{className:N.a.form,children:[Object(g.jsxs)("div",{className:N.a.control,children:[Object(g.jsx)("label",{htmlFor:"new-password",children:"New Password"}),Object(g.jsx)(y.a,{type:"password",id:"new-password",name:"newPassword"}),n.newPassword?Object(g.jsx)("p",{className:"error",children:n.newPassword}):null]}),Object(g.jsxs)("div",{className:N.a.action,children:[!t&&Object(g.jsx)("button",{type:"submit",children:"Change Password"}),t&&Object(g.jsx)("p",{children:"Sending request..."})]})]})}})},A=n(96),D=n.n(A),L=function(){return Object(g.jsxs)("section",{className:D.a.profile,children:[Object(g.jsx)("h1",{children:"Your User Profile"}),Object(g.jsx)(T,{})]})},C=n(22),E=n(27),q=n.n(E),Y=function(){var e=Object(p.useState)(!0),t=Object(C.a)(e,2),n=t[0],r=t[1],a=Object(c.b)(),o=Object(m.g)(),s=function(){r((function(e){return!e}))},i=F.a().shape({email:F.b().email("Email Invalid").required("Required"),password:F.b().min(8,"The minimum is 8 characters").required("Required")}),l=function(){var e=Object(_.a)(k.a.mark((function e(t,r,s){var c,i,l,u;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="",c=n?"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyDXr0-DCQ8hUW6bsSpFmjNHHNokGFOQIBY":"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyDXr0-DCQ8hUW6bsSpFmjNHHNokGFOQIBY",e.prev=2,e.next=5,P.a.post(c,{email:t.email,password:t.password,returnSecureToken:!0});case 5:i=e.sent,l=new Date((new Date).getTime()+1e3*+i.data.expiresIn),a(j.login({token:i.data.idToken,expirationTime:l.toString()})),s(!1),r(),o.replace("/"),e.next=21;break;case 13:throw e.prev=13,e.t0=e.catch(2),u="Authentication failed!",e.t0.response&&e.t0.response.data&&e.t0.response.data.error&&e.t0.response.data.error.message&&(u=e.t0.response.data.error.message),alert(u),s(!1),r(),new Error(u);case 21:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t,n,r){return e.apply(this,arguments)}}();return Object(g.jsxs)("section",{className:q.a.auth,children:[Object(g.jsx)("h1",{children:n?"Login":"Sign Up"}),Object(g.jsx)(y.c,{initialValues:{email:"",password:""},validationSchema:i,onSubmit:function(e,t){var n=t.setSubmitting,r=t.resetForm;l(e,r,n)},children:function(e){var t=e.isSubmitting,r=e.touched,a=e.errors;return Object(g.jsxs)(y.b,{children:[Object(g.jsxs)("div",{className:q.a.control,children:[Object(g.jsx)("label",{htmlFor:"email",children:"Your Email"}),Object(g.jsx)(y.a,{type:"email",name:"email",id:"email",required:!0}),r.email&&a.email?Object(g.jsx)("div",{className:"error",children:a.email}):null]}),Object(g.jsxs)("div",{className:q.a.control,children:[Object(g.jsx)("label",{htmlFor:"password",children:"Your Password"}),Object(g.jsx)(y.a,{type:"password",name:"password",id:"password",required:!0}),r.password&&a.password?Object(g.jsx)("div",{className:"error",children:a.password}):null]}),Object(g.jsxs)("div",{className:q.a.actions,children:[!t&&Object(g.jsx)("button",{type:"submit",children:n?"Login":"Create Account"}),t&&Object(g.jsx)("p",{children:"Sending request..."}),Object(g.jsx)("button",{type:"button",className:q.a.toggle,onClick:s,children:n?"Create new account":"Login with existing account"})]})]})}})]})},H=function(){return Object(g.jsx)(Y,{})},U=n(97),W=n.n(U),B=function(){return Object(g.jsx)("section",{className:W.a.starting,children:Object(g.jsx)("h1",{children:"Welcome on Board!"})})},Q=function(){return Object(g.jsx)(B,{})};var M=function(){var e=Object(c.c)((function(e){return e.auth.isLoggedIn}));return Object(g.jsx)(w,{children:Object(g.jsxs)(m.d,{children:[Object(g.jsx)(m.b,{path:"/",exact:!0,children:Object(g.jsx)(Q,{})}),!e&&Object(g.jsx)(m.b,{path:"/auth",children:Object(g.jsx)(H,{})}),e&&Object(g.jsx)(m.b,{path:"/profile",children:Object(g.jsx)(L,{})}),Object(g.jsx)(m.b,{path:"*",children:Object(g.jsx)(m.a,{to:"/"})})]})})};o.a.render(Object(g.jsx)(c.a,{store:h,children:Object(g.jsx)(s.a,{children:Object(g.jsx)(M,{})})}),document.getElementById("root"))},27:function(e,t,n){e.exports={auth:"AuthForm_auth__k9hdt",control:"AuthForm_control__2PoP1",actions:"AuthForm_actions__MANuH",toggle:"AuthForm_toggle__1_DWl"}},45:function(e,t,n){e.exports={form:"ProfileForm_form__1wEFE",control:"ProfileForm_control__1v8E4",action:"ProfileForm_action__2WYEl"}},56:function(e,t,n){e.exports={header:"MainNavigation_header__1fZ72",logo:"MainNavigation_logo__1yxN8"}},96:function(e,t,n){e.exports={profile:"UserProfile_profile__1BNMs"}},97:function(e,t,n){e.exports={starting:"StartingPageContent_starting__1aDOY"}}},[[229,1,2]]]);
//# sourceMappingURL=main.f5f831a5.chunk.js.map